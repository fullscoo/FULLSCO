import { useState, useEffect } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { Save, RefreshCw, Palette, Globe, Bell, Mail, Share, Layout, ToggleLeft, Type } from 'lucide-react';
import { z } from 'zod';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { useLocation } from 'wouter';
import { useAuth } from '@/hooks/use-auth';
import { cn } from '@/lib/utils';

import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Switch } from '@/components/ui/switch';
import { useToast } from '@/hooks/use-toast';
import AdminLayout from '@/components/admin/admin-layout';
import { Separator } from '@/components/ui/separator';
import { ScrollArea } from '@/components/ui/scroll-area';

// زودج سكيما للتحقق من صحة البيانات
const siteSettingsSchema = z.object({
  siteName: z.string().min(2, 'اسم الموقع يجب أن يكون على الأقل حرفين'),
  siteTagline: z.string().optional(),
  siteDescription: z.string().optional(),
  favicon: z.string().optional(),
  logo: z.string().optional(),
  logoDark: z.string().optional(),
  email: z.string().email('يرجى إدخال بريد إلكتروني صحيح').optional().or(z.literal('')),
  phone: z.string().optional(),
  whatsapp: z.string().optional(),
  address: z.string().optional(),
  facebook: z.string().optional(),
  twitter: z.string().optional(),
  instagram: z.string().optional(),
  youtube: z.string().optional(),
  linkedin: z.string().optional(),
  primaryColor: z.string().optional(),
  secondaryColor: z.string().optional(),
  accentColor: z.string().optional(),
  enableDarkMode: z.boolean().default(true),
  rtlDirection: z.boolean().default(true),
  defaultLanguage: z.string().default('ar'),
  enableNewsletter: z.boolean().default(true),
  enableScholarshipSearch: z.boolean().default(true),
  footerText: z.string().optional(),
  
  // إعدادات إظهار/إخفاء الأقسام
  showHeroSection: z.boolean().default(true),
  showFeaturedScholarships: z.boolean().default(true),
  showSearchSection: z.boolean().default(true),
  showCategoriesSection: z.boolean().default(true),
  showCountriesSection: z.boolean().default(true),
  showLatestArticles: z.boolean().default(true),
  showSuccessStories: z.boolean().default(true),
  showNewsletterSection: z.boolean().default(true),
  showStatisticsSection: z.boolean().default(true),
  showPartnersSection: z.boolean().default(true),
  
  // عناوين وأوصاف الأقسام
  heroTitle: z.string().optional(),
  heroDescription: z.string().optional(),
  featuredScholarshipsTitle: z.string().optional(),
  featuredScholarshipsDescription: z.string().optional(),
  categoriesSectionTitle: z.string().optional(),
  categoriesSectionDescription: z.string().optional(),
  countriesSectionTitle: z.string().optional(),
  countriesSectionDescription: z.string().optional(),
  latestArticlesTitle: z.string().optional(),
  latestArticlesDescription: z.string().optional(),
  successStoriesTitle: z.string().optional(),
  successStoriesDescription: z.string().optional(),
  newsletterSectionTitle: z.string().optional(),
  newsletterSectionDescription: z.string().optional(),
  statisticsSectionTitle: z.string().optional(),
  statisticsSectionDescription: z.string().optional(),
  partnersSectionTitle: z.string().optional(),
  partnersSectionDescription: z.string().optional(),
  
  // خيارات تخطيط الصفحات
  homePageLayout: z.string().default('default'),
  scholarshipPageLayout: z.string().default('default'),
  articlePageLayout: z.string().default('default'),
  customCss: z.string().optional(),
});

type SiteSettingsFormValues = z.infer<typeof siteSettingsSchema>;

// واجهة لإعدادات الموقع
interface SiteSetting {
  id: number;
  siteName: string;
  siteTagline?: string;
  siteDescription?: string;
  favicon?: string;
  logo?: string;
  logoDark?: string;
  email?: string;
  phone?: string;
  whatsapp?: string;
  address?: string;
  facebook?: string;
  twitter?: string;
  instagram?: string;
  youtube?: string;
  linkedin?: string;
  primaryColor?: string;
  secondaryColor?: string;
  accentColor?: string;
  enableDarkMode: boolean;
  rtlDirection: boolean;
  defaultLanguage: string;
  enableNewsletter: boolean;
  enableScholarshipSearch: boolean;
  footerText?: string;
  
  // إعدادات إظهار/إخفاء الأقسام
  showHeroSection?: boolean;
  showFeaturedScholarships?: boolean;
  showSearchSection?: boolean;
  showCategoriesSection?: boolean;
  showCountriesSection?: boolean;
  showLatestArticles?: boolean;
  showSuccessStories?: boolean;
  showNewsletterSection?: boolean;
  showStatisticsSection?: boolean;
  showPartnersSection?: boolean;
  
  // عناوين وأوصاف الأقسام
  heroTitle?: string;
  heroDescription?: string;
  featuredScholarshipsTitle?: string;
  featuredScholarshipsDescription?: string;
  categoriesSectionTitle?: string;
  categoriesSectionDescription?: string;
  countriesSectionTitle?: string;
  countriesSectionDescription?: string;
  latestArticlesTitle?: string;
  latestArticlesDescription?: string;
  successStoriesTitle?: string;
  successStoriesDescription?: string;
  newsletterSectionTitle?: string;
  newsletterSectionDescription?: string;
  statisticsSectionTitle?: string;
  statisticsSectionDescription?: string;
  partnersSectionTitle?: string;
  partnersSectionDescription?: string;
  
  // خيارات تخطيط الصفحات
  homePageLayout?: string;
  scholarshipPageLayout?: string;
  articlePageLayout?: string;
  customCss?: string;
}

// قائمة اللغات المتاحة
const availableLanguages = [
  { code: 'ar', name: 'العربية' },
  { code: 'en', name: 'English' },
  { code: 'fr', name: 'Français' },
];

// قائمة تخطيطات الصفحة الرئيسية
const homePageLayouts = [
  { value: 'default', label: 'التخطيط الافتراضي' },
  { value: 'modern', label: 'التخطيط الحديث' },
  { value: 'minimal', label: 'التخطيط البسيط' },
];

export default function SiteSettingsPage() {
  const { toast } = useToast();
  const queryClient = useQueryClient();
  const [activeTab, setActiveTab] = useState('general');
  const { isLoading: authLoading, isAuthenticated } = useAuth();
  const [, navigate] = useLocation();

  // التحقق من تسجيل الدخول
  useEffect(() => {
    if (!authLoading && !isAuthenticated) {
      navigate('/admin/login');
    }
  }, [authLoading, isAuthenticated, navigate]);

  // استلام إعدادات الموقع من الخادم
  const { 
    data: siteSettings, 
    isLoading, 
    isError, 
    refetch 
  } = useQuery<SiteSetting>({
    queryKey: ['/api/site-settings'],
    queryFn: async () => {
      try {
        const response = await fetch('/api/site-settings');
        if (!response.ok) throw new Error('فشل في استلام إعدادات الموقع');
        return response.json();
      } catch (error) {
        console.error('Error fetching site settings:', error);
        throw error;
      }
    },
    enabled: isAuthenticated,
  });

  console.log('Site settings loaded:', siteSettings);
  console.log('Show hero section:', siteSettings?.showHeroSection);
  console.log('Show categories section:', siteSettings?.showCategoriesSection);
  console.log('Show featured scholarships:', siteSettings?.showFeaturedScholarships);

  // نموذج إعدادات الموقع
  const form = useForm<SiteSettingsFormValues>({
    resolver: zodResolver(siteSettingsSchema),
    defaultValues: {
      siteName: '',
      enableDarkMode: true,
      rtlDirection: true,
      defaultLanguage: 'ar',
      enableNewsletter: true,
      enableScholarshipSearch: true,
      showHeroSection: true,
      showFeaturedScholarships: true,
      showSearchSection: true,
      showCategoriesSection: true,
      showCountriesSection: true,
      showLatestArticles: true,
      showSuccessStories: true,
      showNewsletterSection: true,
      showStatisticsSection: true,
      showPartnersSection: true,
      homePageLayout: 'default',
      scholarshipPageLayout: 'default',
      articlePageLayout: 'default',
    },
  });

  // تحديث قيم النموذج عند استلام البيانات
  useEffect(() => {
    if (siteSettings) {
      // تعيين القيم الافتراضية للحقول التي لم يتم تعيينها في البيانات المستلمة
      const formValues: SiteSettingsFormValues = {
        siteName: siteSettings.siteName,
        siteTagline: siteSettings.siteTagline || '',
        siteDescription: siteSettings.siteDescription || '',
        favicon: siteSettings.favicon || '',
        logo: siteSettings.logo || '',
        logoDark: siteSettings.logoDark || '',
        email: siteSettings.email || '',
        phone: siteSettings.phone || '',
        whatsapp: siteSettings.whatsapp || '',
        address: siteSettings.address || '',
        facebook: siteSettings.facebook || '',
        twitter: siteSettings.twitter || '',
        instagram: siteSettings.instagram || '',
        youtube: siteSettings.youtube || '',
        linkedin: siteSettings.linkedin || '',
        primaryColor: siteSettings.primaryColor || '#3b82f6',
        secondaryColor: siteSettings.secondaryColor || '#f59e0b',
        accentColor: siteSettings.accentColor || '#a855f7',
        enableDarkMode: siteSettings.enableDarkMode,
        rtlDirection: siteSettings.rtlDirection,
        defaultLanguage: siteSettings.defaultLanguage,
        enableNewsletter: siteSettings.enableNewsletter,
        enableScholarshipSearch: siteSettings.enableScholarshipSearch,
        footerText: siteSettings.footerText || '',
        
        // إعدادات إظهار/إخفاء الأقسام
        showHeroSection: siteSettings.showHeroSection ?? true,
        showFeaturedScholarships: siteSettings.showFeaturedScholarships ?? true,
        showSearchSection: siteSettings.showSearchSection ?? true,
        showCategoriesSection: siteSettings.showCategoriesSection ?? true,
        showCountriesSection: siteSettings.showCountriesSection ?? true,
        showLatestArticles: siteSettings.showLatestArticles ?? true,
        showSuccessStories: siteSettings.showSuccessStories ?? true,
        showNewsletterSection: siteSettings.showNewsletterSection ?? true,
        showStatisticsSection: siteSettings.showStatisticsSection ?? true,
        showPartnersSection: siteSettings.showPartnersSection ?? true,
        
        // عناوين وأوصاف الأقسام
        heroTitle: siteSettings.heroTitle || '',
        heroDescription: siteSettings.heroDescription || '',
        featuredScholarshipsTitle: siteSettings.featuredScholarshipsTitle || '',
        featuredScholarshipsDescription: siteSettings.featuredScholarshipsDescription || '',
        categoriesSectionTitle: siteSettings.categoriesSectionTitle || '',
        categoriesSectionDescription: siteSettings.categoriesSectionDescription || '',
        countriesSectionTitle: siteSettings.countriesSectionTitle || '',
        countriesSectionDescription: siteSettings.countriesSectionDescription || '',
        latestArticlesTitle: siteSettings.latestArticlesTitle || '',
        latestArticlesDescription: siteSettings.latestArticlesDescription || '',
        successStoriesTitle: siteSettings.successStoriesTitle || '',
        successStoriesDescription: siteSettings.successStoriesDescription || '',
        newsletterSectionTitle: siteSettings.newsletterSectionTitle || '',
        newsletterSectionDescription: siteSettings.newsletterSectionDescription || '',
        statisticsSectionTitle: siteSettings.statisticsSectionTitle || '',
        statisticsSectionDescription: siteSettings.statisticsSectionDescription || '',
        partnersSectionTitle: siteSettings.partnersSectionTitle || '',
        partnersSectionDescription: siteSettings.partnersSectionDescription || '',
        
        // خيارات تخطيط الصفحات
        homePageLayout: siteSettings.homePageLayout || 'default',
        scholarshipPageLayout: siteSettings.scholarshipPageLayout || 'default',
        articlePageLayout: siteSettings.articlePageLayout || 'default',
        customCss: siteSettings.customCss || '',
      };

      // reset form with data
      form.reset(formValues);
    }
  }, [siteSettings, form]);

  // تحديث إعدادات الموقع - mutation
  const updateMutation = useMutation({
    mutationFn: async (updatedSettings: SiteSettingsFormValues) => {
      const response = await fetch('/api/site-settings', {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(updatedSettings),
      });
      
      if (!response.ok) {
        throw new Error('فشل في تحديث إعدادات الموقع');
      }
      
      return response.json();
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['/api/site-settings'] });
      toast({
        title: "تم تحديث الإعدادات بنجاح",
        description: "تم حفظ إعدادات الموقع بنجاح",
      });
    },
    onError: (error) => {
      console.error('Error updating site settings:', error);
      toast({
        title: "خطأ في تحديث الإعدادات",
        description: "حدث خطأ أثناء محاولة تحديث إعدادات الموقع",
        variant: "destructive",
      });
    },
  });

  // تقديم النموذج
  const onSubmit = (data: SiteSettingsFormValues) => {
    console.log('Form submitted with values:', data);
    
    // إرسال البيانات من خلال mutation
    updateMutation.mutate(data);
  };
  
  // عرض شاشة التحميل
  if (authLoading || !isAuthenticated) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        جاري التحميل...
      </div>
    );
  }
  
  // تحضير أزرار الإجراءات لشريط العنوان
  const actions = (
    <>
      <Button variant="outline" onClick={() => refetch()}>
        <RefreshCw className="ml-2 h-4 w-4" />
        تحديث
      </Button>
      
      <Button 
        onClick={form.handleSubmit(onSubmit)}
        disabled={updateMutation.isPending || isLoading}
      >
        {updateMutation.isPending ? (
          <div className="mr-2 h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-r-transparent"></div>
        ) : (
          <Save className="ml-2 h-4 w-4" />
        )}
        حفظ التغييرات
      </Button>
    </>
  );

  return (
    <AdminLayout title="إعدادات الموقع" actions={actions}>
      <div className="p-4 md:p-6">
        <div className="mb-6">
          <Card>
            <CardContent className="p-6">
              <Form {...form}>
                <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-8">
                  <Tabs defaultValue="general" value={activeTab} onValueChange={setActiveTab} className="w-full">
                    <ScrollArea className="pb-4">
                      <TabsList className="w-full justify-start mb-4 overflow-x-auto">
                        <TabsTrigger value="general">
                          <Globe className="ml-2 h-4 w-4" />
                          إعدادات عامة
                        </TabsTrigger>
                        <TabsTrigger value="appearance">
                          <Palette className="ml-2 h-4 w-4" />
                          المظهر والألوان
                        </TabsTrigger>
                        <TabsTrigger value="contact">
                          <Mail className="ml-2 h-4 w-4" />
                          معلومات الاتصال
                        </TabsTrigger>
                        <TabsTrigger value="social">
                          <Share className="ml-2 h-4 w-4" />
                          التواصل الاجتماعي
                        </TabsTrigger>
                        <TabsTrigger value="homepage">
                          <Layout className="ml-2 h-4 w-4" />
                          الصفحة الرئيسية
                        </TabsTrigger>
                        <TabsTrigger value="sections">
                          <ToggleLeft className="ml-2 h-4 w-4" />
                          إظهار/إخفاء الأقسام
                        </TabsTrigger>
                        <TabsTrigger value="content">
                          <Type className="ml-2 h-4 w-4" />
                          محتوى الأقسام
                        </TabsTrigger>
                        <TabsTrigger value="notifications">
                          <Bell className="ml-2 h-4 w-4" />
                          الإشعارات
                        </TabsTrigger>
                      </TabsList>
                    </ScrollArea>
                    
                    {/* إعدادات عامة */}
                    <TabsContent value="general" className="space-y-6">
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="siteName"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>اسم الموقع</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="اسم الموقع الإلكتروني" />
                              </FormControl>
                              <FormDescription>
                                سيظهر هذا الاسم في عنوان الصفحة وفي مختلف أنحاء الموقع
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="siteTagline"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>شعار الموقع</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="الشعار أو الوصف المختصر للموقع" />
                              </FormControl>
                              <FormDescription>
                                سيظهر هذا الوصف المختصر تحت اسم الموقع
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <FormField
                        control={form.control}
                        name="siteDescription"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>وصف الموقع</FormLabel>
                            <FormControl>
                              <Textarea
                                {...field}
                                placeholder="وصف كامل للموقع"
                                rows={3}
                              />
                            </FormControl>
                            <FormDescription>
                              سيستخدم هذا الوصف في محركات البحث وفي الميتا تاغ للصفحات
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                      
                      {/* تم إزالة خيارات RTL والوضع المظلم واللغة الافتراضية بناءً على طلب المستخدم */}
                      
                      <FormField
                        control={form.control}
                        name="footerText"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>نص التذييل</FormLabel>
                            <FormControl>
                              <Input {...field} placeholder="© 2025 اسم الموقع. جميع الحقوق محفوظة." />
                            </FormControl>
                            <FormDescription>
                              النص الذي سيظهر في تذييل الموقع
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                    </TabsContent>
                    
                    {/* المظهر والألوان */}
                    <TabsContent value="appearance" className="space-y-6">
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="logo"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>شعار الموقع (الوضع الفاتح)</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="رابط صورة الشعار" />
                              </FormControl>
                              <FormDescription>
                                صورة شعار الموقع في الوضع الفاتح
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="logoDark"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>شعار الموقع (الوضع المظلم)</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="رابط صورة الشعار للوضع المظلم" />
                              </FormControl>
                              <FormDescription>
                                صورة شعار الموقع في الوضع المظلم
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <FormField
                        control={form.control}
                        name="favicon"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>أيقونة الموقع (Favicon)</FormLabel>
                            <FormControl>
                              <Input {...field} placeholder="رابط أيقونة الموقع" />
                            </FormControl>
                            <FormDescription>
                              الأيقونة الصغيرة التي تظهر في علامة التبويب للمتصفح
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                      
                      <div className="grid gap-6 md:grid-cols-3">
                        <FormField
                          control={form.control}
                          name="primaryColor"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>اللون الرئيسي</FormLabel>
                              <div className="flex">
                                <FormControl>
                                  <Input {...field} type="text" placeholder="#3b82f6" />
                                </FormControl>
                                <Input
                                  type="color"
                                  value={field.value || '#3b82f6'}
                                  onChange={(e) => field.onChange(e.target.value)}
                                  className="w-12 p-1 ml-2"
                                />
                              </div>
                              <FormDescription>
                                اللون الرئيسي للعناصر التفاعلية والأزرار
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="secondaryColor"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>اللون الثانوي</FormLabel>
                              <div className="flex">
                                <FormControl>
                                  <Input {...field} type="text" placeholder="#f59e0b" />
                                </FormControl>
                                <Input
                                  type="color"
                                  value={field.value || '#f59e0b'}
                                  onChange={(e) => field.onChange(e.target.value)}
                                  className="w-12 p-1 ml-2"
                                />
                              </div>
                              <FormDescription>
                                اللون الثانوي المستخدم للتأكيد والإبراز
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="accentColor"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>لون التمييز</FormLabel>
                              <div className="flex">
                                <FormControl>
                                  <Input {...field} type="text" placeholder="#a855f7" />
                                </FormControl>
                                <Input
                                  type="color"
                                  value={field.value || '#a855f7'}
                                  onChange={(e) => field.onChange(e.target.value)}
                                  className="w-12 p-1 ml-2"
                                />
                              </div>
                              <FormDescription>
                                لون تمييز إضافي للعناصر المهمة
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <div className="grid gap-6 md:grid-cols-3">
                        <FormField
                          control={form.control}
                          name="homePageLayout"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>تخطيط الصفحة الرئيسية</FormLabel>
                              <div className="space-y-2">
                                {homePageLayouts.map((layout) => (
                                  <div key={layout.value} className="flex items-center space-x-2 space-x-reverse">
                                    <FormControl>
                                      <input
                                        type="radio"
                                        id={`home-layout-${layout.value}`}
                                        value={layout.value}
                                        checked={field.value === layout.value}
                                        onChange={(e) => field.onChange(e.target.value)}
                                        className="h-4 w-4"
                                      />
                                    </FormControl>
                                    <label
                                      htmlFor={`home-layout-${layout.value}`}
                                      className="text-sm font-medium leading-none cursor-pointer"
                                    >
                                      {layout.label}
                                    </label>
                                  </div>
                                ))}
                              </div>
                              <FormDescription>
                                نمط تخطيط الصفحة الرئيسية
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="scholarshipPageLayout"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>تخطيط صفحة المنح</FormLabel>
                              <div className="space-y-2">
                                {homePageLayouts.map((layout) => (
                                  <div key={layout.value} className="flex items-center space-x-2 space-x-reverse">
                                    <FormControl>
                                      <input
                                        type="radio"
                                        id={`scholarship-layout-${layout.value}`}
                                        value={layout.value}
                                        checked={field.value === layout.value}
                                        onChange={(e) => field.onChange(e.target.value)}
                                        className="h-4 w-4"
                                      />
                                    </FormControl>
                                    <label
                                      htmlFor={`scholarship-layout-${layout.value}`}
                                      className="text-sm font-medium leading-none cursor-pointer"
                                    >
                                      {layout.label}
                                    </label>
                                  </div>
                                ))}
                              </div>
                              <FormDescription>
                                نمط تخطيط صفحة المنح الدراسية
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="articlePageLayout"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>تخطيط صفحة المقالات</FormLabel>
                              <div className="space-y-2">
                                {homePageLayouts.map((layout) => (
                                  <div key={layout.value} className="flex items-center space-x-2 space-x-reverse">
                                    <FormControl>
                                      <input
                                        type="radio"
                                        id={`article-layout-${layout.value}`}
                                        value={layout.value}
                                        checked={field.value === layout.value}
                                        onChange={(e) => field.onChange(e.target.value)}
                                        className="h-4 w-4"
                                      />
                                    </FormControl>
                                    <label
                                      htmlFor={`article-layout-${layout.value}`}
                                      className="text-sm font-medium leading-none cursor-pointer"
                                    >
                                      {layout.label}
                                    </label>
                                  </div>
                                ))}
                              </div>
                              <FormDescription>
                                نمط تخطيط صفحة المقالات
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <FormField
                        control={form.control}
                        name="customCss"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>CSS مخصص</FormLabel>
                            <FormControl>
                              <Textarea
                                {...field}
                                placeholder="/* أضف أكواد CSS المخصصة هنا */"
                                rows={6}
                                className="font-mono text-sm"
                              />
                            </FormControl>
                            <FormDescription>
                              أكواد CSS مخصصة ستضاف إلى الموقع (استخدم بحذر)
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                    </TabsContent>
                    
                    {/* معلومات الاتصال */}
                    <TabsContent value="contact" className="space-y-6">
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="email"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>البريد الإلكتروني</FormLabel>
                              <FormControl>
                                <Input {...field} type="email" placeholder="info@example.com" />
                              </FormControl>
                              <FormDescription>
                                عنوان البريد الإلكتروني الرئيسي للاتصال
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="phone"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>رقم الهاتف</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="+1234567890" />
                              </FormControl>
                              <FormDescription>
                                رقم الهاتف للاتصال
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <FormField
                        control={form.control}
                        name="whatsapp"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>رقم واتساب</FormLabel>
                            <FormControl>
                              <Input {...field} placeholder="+1234567890" />
                            </FormControl>
                            <FormDescription>
                              رقم واتساب للدعم والاستفسارات
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                      
                      <FormField
                        control={form.control}
                        name="address"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>العنوان</FormLabel>
                            <FormControl>
                              <Textarea
                                {...field}
                                placeholder="عنوان المكتب أو المقر"
                                rows={3}
                              />
                            </FormControl>
                            <FormDescription>
                              عنوان المكتب أو المقر الرئيسي
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                    </TabsContent>
                    
                    {/* التواصل الاجتماعي */}
                    <TabsContent value="social" className="space-y-6">
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="facebook"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>فيسبوك</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="https://facebook.com/yourpage" />
                              </FormControl>
                              <FormDescription>
                                رابط صفحة الفيسبوك
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="twitter"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>تويتر</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="https://twitter.com/yourhandle" />
                              </FormControl>
                              <FormDescription>
                                رابط حساب تويتر
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="instagram"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>انستغرام</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="https://instagram.com/yourprofile" />
                              </FormControl>
                              <FormDescription>
                                رابط حساب انستغرام
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="youtube"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>يوتيوب</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="https://youtube.com/yourchannel" />
                              </FormControl>
                              <FormDescription>
                                رابط قناة اليوتيوب
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <FormField
                        control={form.control}
                        name="linkedin"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel>لينكد إن</FormLabel>
                            <FormControl>
                              <Input {...field} placeholder="https://linkedin.com/company/yourcompany" />
                            </FormControl>
                            <FormDescription>
                              رابط صفحة لينكد إن
                            </FormDescription>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                    </TabsContent>
                    
                    {/* الصفحة الرئيسية */}
                    <TabsContent value="homepage" className="space-y-6">
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="heroTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم البانر الرئيسي</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="ابحث عن المنح الدراسية المناسبة لك" />
                              </FormControl>
                              <FormDescription>
                                العنوان الرئيسي في قسم البانر
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="heroDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم البانر الرئيسي</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="أكبر قاعدة بيانات للمنح الدراسية حول العالم" />
                              </FormControl>
                              <FormDescription>
                                الوصف المختصر تحت العنوان في قسم البانر
                              </FormDescription>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                    </TabsContent>
                    
                    {/* إظهار/إخفاء الأقسام */}
                    <TabsContent value="sections" className="space-y-6">
                      <div className="grid gap-4 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="showHeroSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم البانر الرئيسي</FormLabel>
                                <FormDescription>
                                  قسم البانر الكبير في أعلى الصفحة الرئيسية
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showSearchSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم البحث</FormLabel>
                                <FormDescription>
                                  قسم البحث عن المنح الدراسية
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showFeaturedScholarships"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم المنح المميزة</FormLabel>
                                <FormDescription>
                                  قسم يعرض المنح الدراسية المميزة
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showCategoriesSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم التصنيفات</FormLabel>
                                <FormDescription>
                                  قسم يعرض تصنيفات المنح الدراسية
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showCountriesSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم الدول</FormLabel>
                                <FormDescription>
                                  قسم يعرض الدول المتاحة للمنح الدراسية
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showLatestArticles"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم أحدث المقالات</FormLabel>
                                <FormDescription>
                                  قسم يعرض أحدث المقالات المنشورة
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showSuccessStories"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم قصص النجاح</FormLabel>
                                <FormDescription>
                                  قسم يعرض قصص نجاح الطلاب
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showNewsletterSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم النشرة البريدية</FormLabel>
                                <FormDescription>
                                  قسم الاشتراك في النشرة البريدية
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showStatisticsSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم الإحصائيات</FormLabel>
                                <FormDescription>
                                  قسم يعرض إحصائيات عن المنح والطلاب
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                        
                        <FormField
                          control={form.control}
                          name="showPartnersSection"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                              <div className="space-y-0.5">
                                <FormLabel className="text-base">قسم الشركاء</FormLabel>
                                <FormDescription>
                                  قسم يعرض شعارات الشركاء والرعاة
                                </FormDescription>
                              </div>
                              <FormControl>
                                <Switch
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                            </FormItem>
                          )}
                        />
                      </div>
                    </TabsContent>
                    
                    {/* محتوى الأقسام */}
                    <TabsContent value="content" className="space-y-6">
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى المنح المميزة</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="featuredScholarshipsTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم المنح المميزة</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="منح دراسية مميزة" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="featuredScholarshipsDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم المنح المميزة</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="أبرز المنح الدراسية المتاحة حالياً" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم التصنيفات</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="categoriesSectionTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم التصنيفات</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="تصفح حسب التخصص" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="categoriesSectionDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم التصنيفات</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="اختر المنح المناسبة حسب مجال دراستك" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم الدول</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="countriesSectionTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم الدول</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="تصفح حسب الدولة" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="countriesSectionDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم الدول</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="استكشف فرص الدراسة في بلدان مختلفة" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم المقالات</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="latestArticlesTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم المقالات</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="أحدث المقالات" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="latestArticlesDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم المقالات</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="تعرف على آخر النصائح والمعلومات" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم قصص النجاح</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="successStoriesTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم قصص النجاح</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="قصص نجاح" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="successStoriesDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم قصص النجاح</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="تجارب حقيقية للطلاب الذين حصلوا على منح دراسية" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم النشرة البريدية</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="newsletterSectionTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم النشرة البريدية</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="النشرة البريدية" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="newsletterSectionDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم النشرة البريدية</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="اشترك ليصلك كل جديد عن المنح الدراسية" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم الإحصائيات</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="statisticsSectionTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم الإحصائيات</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="إحصائيات" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="statisticsSectionDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم الإحصائيات</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="أرقام عن المنح الدراسية والطلاب حول العالم" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                      
                      <Separator className="my-4" />
                      <h3 className="text-lg font-medium">محتوى قسم الشركاء</h3>
                      <div className="grid gap-6 md:grid-cols-2">
                        <FormField
                          control={form.control}
                          name="partnersSectionTitle"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>عنوان قسم الشركاء</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="شركاؤنا" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                        <FormField
                          control={form.control}
                          name="partnersSectionDescription"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel>وصف قسم الشركاء</FormLabel>
                              <FormControl>
                                <Input {...field} placeholder="المؤسسات والجامعات التي نتعاون معها" />
                              </FormControl>
                              <FormMessage />
                            </FormItem>
                          )}
                        />
                      </div>
                    </TabsContent>
                    
                    {/* الإشعارات */}
                    <TabsContent value="notifications" className="space-y-6">
                      <FormField
                        control={form.control}
                        name="enableNewsletter"
                        render={({ field }) => (
                          <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                            <div className="space-y-0.5">
                              <FormLabel className="text-base">النشرة البريدية</FormLabel>
                              <FormDescription>
                                تفعيل نظام النشرة البريدية واستقبال المشتركين
                              </FormDescription>
                            </div>
                            <FormControl>
                              <Switch
                                checked={field.value}
                                onCheckedChange={field.onChange}
                              />
                            </FormControl>
                          </FormItem>
                        )}
                      />
                      
                      <FormField
                        control={form.control}
                        name="enableScholarshipSearch"
                        render={({ field }) => (
                          <FormItem className="flex flex-row items-center justify-between rounded-lg border p-4">
                            <div className="space-y-0.5">
                              <FormLabel className="text-base">البحث عن المنح</FormLabel>
                              <FormDescription>
                                تفعيل نظام البحث عن المنح الدراسية
                              </FormDescription>
                            </div>
                            <FormControl>
                              <Switch
                                checked={field.value}
                                onCheckedChange={field.onChange}
                              />
                            </FormControl>
                          </FormItem>
                        )}
                      />
                    </TabsContent>
                  </Tabs>
                </form>
              </Form>
            </CardContent>
          </Card>
        </div>
      </div>
    </AdminLayout>
  );
}